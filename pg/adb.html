<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Multi-Subject Quiz</title>
  <link rel="shortcut icon" href="icon.png" type="image/png">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #000;
      padding: 20px;
    }
    #container, #quiz-container, #result-container {
      max-width: 600px;
      margin: auto;
      background: #000;
      padding: 20px;
      border-radius: 8px;
      color: white;
      box-shadow: 0 4px 8px rgba(220, 20, 200, 0.932);
    }
    h2 { text-align: center; }
    .answer-btn {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      border: none;
      background: #ddd;
      border-radius: 5px;
      cursor: pointer;
    }
    .answer-btn.correct { background: #4CAF50; color: white; }
    .answer-btn.wrong { background: #f44336; color: white; }
    #next-btn, #prev-btn, .part-btn {
      margin: 10px;
      padding: 10px 20px;
      background: #9C27B0;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #prev-btn { float: left; }
    #next-btn { float: right; }
    #score { font-weight: bold; }
    #timer { text-align: right; font-weight: bold; }

    .clearfix::after {
      content: "";
      display: table;
      clear: both;
    }
    #part-selection-subject1, #part-selection-subject2, #part-selection-subject3 .part-btn{
      text-align: center;
    }

    .subject-card {
      background: #1e1e1e;
      color: white;
      padding: 20px;
      width: 200px;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(255, 0, 255, 0.5);
      cursor: pointer;
      text-align: center;
      font-size: 18px;
      transition: 0.3s;
    }
    .subject-card:hover { background: #9C27B0; }

    .subject-page {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <div id="container">
    <!-- Subject Selection Page -->
    <div id="subject-selection">
      <h2>Select a Subject</h2>
      <div class="subject-page">
        <div class="subject-card" onclick="goToSubject('subject1')">مقومات النهضة وعواملها</div>
        <div class="subject-card" onclick="goToSubject('subject2')">الشعر في العصر الحديث</div>
        <div class="subject-card" onclick="goToSubject('subject3')">مشاهير الأدباء في العصر الحديث</div>
      </div>
    </div>

    <!-- Subject 1 Part Page -->
    <div id="part-selection-subject1" style="display: none;">
      <h2>مقومات النهضة وعواملها</h2>
      <button class="part-btn" onclick="startQuiz('part1')">Part 1</button>
      <button class="part-btn" onclick="startQuiz('part2')">Part 2</button>
      <button class="part-btn" onclick="startQuiz('part3')">Part 3</button>
    </div>

    <!-- Subject 2 Part Page -->
    <div id="part-selection-subject2" style="display: none;">
      <h2>الشعر في العصر الحديث</h2>
      <button class="part-btn" onclick="startQuiz('part4')">Part 1</button>
      <button class="part-btn" onclick="startQuiz('part5')">Part 2</button>
      <button class="part-btn" onclick="startQuiz('part6')">Part 3</button>
    </div>

    <!-- Subject 2 Part Page -->
    <div id="part-selection-subject3" style="display: none;">
      <h2>مشاهير الأدباء في العصر الحديث</h2>
      <button class="part-btn" onclick="startQuiz('part7')">Part 1</button>
      <button class="part-btn" onclick="startQuiz('part8')">Part 2</button>
      <button class="part-btn" onclick="startQuiz('part9')">Part 3</button>
    </div>

    <!-- Quiz Container -->
    <div id="quiz-container" style="display: none;">
      <div id="timer">60m 0s</div>
      <h2 id="question-number"></h2>
      <p id="question"></p>
      <button class="answer-btn"></button>
      <button class="answer-btn"></button>
      <button class="answer-btn"></button>
      <button class="answer-btn"></button>
      <div class="clearfix">
        <button id="prev-btn" onclick="prevQuestion()" style="display: none;">Previous</button>
        <button id="next-btn" onclick="nextQuestion()" style="display: none;">Next</button>
      </div>
    </div>

    <!-- Result Container -->
    <div id="result-container" style="display: none;">
      <h2>Quiz Finished!</h2>
      <p id="score"></p>
    </div>
  </div>

  <script>
    let quizData = [];
    let currentQuestion = 0;
    let score = 0;
    let timeRemaining = 3600;

    const csvUrls = {
  part1: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZS4b7ckl_90BDHpqQ1nORa-oM1hXYO5IVWC6cMw--oWRXxdUD9RSxHoYIKTbInXSHAZKF08rY-7YR/pub?output=csv&gid=0",
  part2: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZS4b7ckl_90BDHpqQ1nORa-oM1hXYO5IVWC6cMw--oWRXxdUD9RSxHoYIKTbInXSHAZKF08rY-7YR/pub?output=csv&gid=499131029",
  part3: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZS4b7ckl_90BDHpqQ1nORa-oM1hXYO5IVWC6cMw--oWRXxdUD9RSxHoYIKTbInXSHAZKF08rY-7YR/pub?output=csv&gid=497045516",
  part4: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZS4b7ckl_90BDHpqQ1nORa-oM1hXYO5IVWC6cMw--oWRXxdUD9RSxHoYIKTbInXSHAZKF08rY-7YR/pub?output=csv&gid=522585307",
  part5: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZS4b7ckl_90BDHpqQ1nORa-oM1hXYO5IVWC6cMw--oWRXxdUD9RSxHoYIKTbInXSHAZKF08rY-7YR/pub?output=csv&gid=413092225",
  part6: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZS4b7ckl_90BDHpqQ1nORa-oM1hXYO5IVWC6cMw--oWRXxdUD9RSxHoYIKTbInXSHAZKF08rY-7YR/pub?output=csv&gid=1467671128",
  part7: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZS4b7ckl_90BDHpqQ1nORa-oM1hXYO5IVWC6cMw--oWRXxdUD9RSxHoYIKTbInXSHAZKF08rY-7YR/pub?output=csv&gid=1074375691",
  part8: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZS4b7ckl_90BDHpqQ1nORa-oM1hXYO5IVWC6cMw--oWRXxdUD9RSxHoYIKTbInXSHAZKF08rY-7YR/pub?output=csv&gid=710622141",
  part9: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZS4b7ckl_90BDHpqQ1nORa-oM1hXYO5IVWC6cMw--oWRXxdUD9RSxHoYIKTbInXSHAZKF08rY-7YR/pub?output=csv&gid=359016621"
};


    function goToSubject(subject) {
      document.getElementById("subject-selection").style.display = "none";
      if (subject === "subject1") {
        document.getElementById("part-selection-subject1").style.display = "block";
      } else if (subject === "subject2") {
        document.getElementById("part-selection-subject2").style.display = "block";
      } else if (subject === "subject3") {
        document.getElementById("part-selection-subject3").style.display = "block";
      }
    }

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    async function fetchQuizData(part) {
      try {
        const response = await fetch(csvUrls[part]);
        const csvText = await response.text();
        const rows = csvText.split("\n").map(row => row.split(",").map(cell => cell.trim()));
        quizData = shuffleArray(rows.slice(1).map(row => ({
          question: row[0],
          options: row.slice(1, 5),
          correct: 0 // First option always correct
        })));
        document.getElementById("part-selection-subject1").style.display = "none";
        document.getElementById("part-selection-subject2").style.display = "none";
        document.getElementById("part-selection-subject3").style.display = "none";
        document.getElementById("quiz-container").style.display = "block";
        startTimer();
        loadQuestion();
      } catch (error) {
        alert("Failed to load quiz data.");
        console.error(error);
      }
    }

    function startQuiz(part) {
      currentQuestion = 0;
      score = 0;
      timeRemaining = 3600;
      fetchQuizData(part);
    }

    function startTimer() {
      const timerElement = document.getElementById("timer");
      const interval = setInterval(() => {
        timeRemaining--;
        const minutes = Math.floor(timeRemaining / 60);
        const seconds = timeRemaining % 60;
        timerElement.textContent = `${minutes}m ${seconds}s`;
        if (timeRemaining <= 0) {
          clearInterval(interval);
          showResults();
        }
      }, 1000);
    }

    function loadQuestion() {
      const questionObj = quizData[currentQuestion];
      document.getElementById("question").textContent = questionObj.question;
      document.getElementById("question-number").textContent = `Question ${currentQuestion + 1} of ${quizData.length}`;
      const buttons = document.querySelectorAll(".answer-btn");
      buttons.forEach((btn, index) => {
        btn.textContent = questionObj.options[index];
        btn.className = "answer-btn";
        btn.disabled = false;
        btn.onclick = () => checkAnswer(btn, index);
      });
      document.getElementById("prev-btn").style.display = currentQuestion > 0 ? "inline-block" : "none";
      document.getElementById("next-btn").style.display = "none";
    }

    function checkAnswer(button, index) {
      const correct = 0;
      const buttons = document.querySelectorAll(".answer-btn");
      if (index === correct) {
        button.classList.add("correct");
        score++;
      } else {
        button.classList.add("wrong");
        buttons[correct].classList.add("correct");
      }
      buttons.forEach(btn => btn.disabled = true);
      document.getElementById("next-btn").style.display = "inline-block";
    }

    function nextQuestion() {
      currentQuestion++;
      if (currentQuestion < quizData.length) {
        loadQuestion();
      } else {
        showResults();
      }
    }

    function prevQuestion() {
      if (currentQuestion > 0) {
        currentQuestion--;
        loadQuestion();
      }
    }

    function showResults() {
      document.getElementById("quiz-container").style.display = "none";
      document.getElementById("result-container").style.display = "block";
      document.getElementById("score").textContent = `You scored ${score} out of ${quizData.length}`;
    }
  </script>
</body>
</html>
